# Memo→Inbox 変換

## Description

00_Memo の雑なメモを全て 01_Inbox の形式に整形して変換します（承認不要で自動実行）。

**重要**: 全てのファイルの中身を必ず読み込んで、内容を丁寧に分析してから整形します。

## 使用するツール

- `glob_file_search`: `.md` ファイルを検索
- `read_file`: ファイル内容を読み込む（複数ファイルを並列実行可能）
- `write`: Inbox 形式のファイルを作成
- `run_terminal_cmd`: ファイルの移動（mv コマンド）
- `delete_file`: ファイルの削除（必要な場合）

## Prompt

指定された 00_Memo のメモを 01_Inbox の形式に整理して移動してください。

引数:

- Memo ファイル名（省略可）: 変換元のファイル。省略時は 00_Memo 内の全ファイルをリスト表示

実行内容:

1. 00_Memo のメモを全て読み込む
2. 内容を分析して整理
3. 日付フォーマット `YYYYMMDD_内容.md` でファイル名を生成
4. 内容を整形して 01_Inbox 形式に変換
5. **自動的に** `01_Inbox/` に作成
6. 元のファイルは `99_Archive/` に移動
7. 変換後に 00_Memo 内の空のフォルダを自動削除

## 変換ルール

### ファイル名

- 元のファイル名に関係なく、内容からタイトルを生成
- 形式: `YYYYMMDD_内容.md`
- 例: `20251022_Next.jsのApp Router入門.md`

### 内容構成

```markdown
# [タイトル]

## 概要

[何についてのメモか、1-2 文で要約]

## 内容

[元のメモの内容を整理]

## コードスニペット

[コードが含まれている場合、ここに整理して配置]

\`\`\`[言語名]
[コード内容]
\`\`\`

## 次アクション

- [ ] 調べる必要があること
- [ ] 関連ノートにリンク
- [ ] 必要に応じて Memory Note に変換（コードスニペットの場合）

#inbox #tag1 #tag2 #[言語名]-snippet
```

### トピック分割の判断基準

1 つのメモに複数のトピックが含まれている場合、分割する：

- そのトピックだけで 1 つの独立したノートになるか？
- 別のトピックと混ぜても理解に支障がないか？
- 検索した時に「○○ について知りたい」で見つかるか？

分割する場合は、各トピックごとに別ファイルを作成

### コードスニペットの処理ルール

メモに HTML、CSS、JavaScript、その他のコードが含まれている場合：

1. **コードブロックの検出**:

   - Markdown のコードブロック（\`\`\`言語名 で囲まれた部分）を検出
   - インラインコード（\`コード\`）も検出
   - コードブロックの言語名を識別（html, css, javascript, js, typescript, ts, python, etc.）

2. **コードの整形**:

   - コードブロックの言語名を保持
   - インデントやフォーマットを整理（可能な限り）
   - 不要な空行を削除（ただし、可読性を損なわない範囲で）
   - コメントや説明が含まれている場合は保持

3. **コードスニペットセクションの追加**:

   - コードが含まれている場合は「## コードスニペット」セクションを追加
   - 複数のコードブロックがある場合は、それぞれを適切に配置
   - HTML、CSS、JS が一緒にある場合は、関連性を考慮して配置

4. **タグの追加**:

   - コードの言語に応じたタグを追加
   - 例: `#html-snippet`, `#css-snippet`, `#javascript-snippet`, `#typescript-snippet`
   - 複数の言語がある場合は全てのタグを追加

5. **ファイル名の生成**:

   - コードが主な内容の場合は、コードの種類をファイル名に含める
   - 例: `20250113_レスポンシブヘッダー-HTML-CSS実装.md`
   - 例: `20250113_マウスストーカーボタン-JavaScript実装.md`

6. **次アクションの追加**:
   - コードスニペットの場合は「必要に応じて Memory Note に変換」を追加
   - 特に再利用可能なコードの場合は、`04_Memory/Technical/Programming/` への移動を推奨

## 出力形式

```markdown
## Memo→Inbox 変換レポート

### 変換対象ファイル

- 00_Memo/[元のファイル名]

### 作成されるファイル

1. 01*Inbox/YYYYMMDD*タイトル 1.md

   - 内容: [要約]
   - トピック数: [分割した場合]

2. 01*Inbox/YYYYMMDD*タイトル 2.md
   - 内容: [要約]
   - トピック数: [分割した場合]

### 変換後の内容プレビュー

---

（変換後のプレビューをここに表示）

---

## 実行結果

✅ 01*Inbox/YYYYMMDD*タイトル 1.md を作成しました
✅ 元のファイルは 99_Archive/ に移動しました
✅ 空のフォルダ 0 個を削除しました
```

## 実行手順

### ステップ 1: ファイルの検索とリスト化

1. `00_Memo/` 内の全ての `.md` ファイルを検索（日付フォルダ内も含む）
2. ファイル一覧を取得
3. 引数が指定されている場合は該当ファイルのみ、省略されている場合は全ファイルを処理

### ステップ 2: ファイルの読み込み（最重要）

**全ファイルを必ず 1 つ 1 つ丁寧に読み込む**

1. **全てのファイルの中身を必ず読み込む**（ファイル名だけで判断しない）
2. 複数ファイルがある場合でも、各ファイルの内容をしっかり確認する
3. `read_file` ツールを使って、ファイル全体を読み込む（複数ファイルを並列読み込み可能だが、各ファイルの内容は必ず確認）

### ステップ 3: 変換処理（全てのファイル）

**全てのファイルを整形して Inbox 形式に変換する**

1. **メタデータの削除**:

   - `---` で囲まれたメタデータセクションを削除
   - `## 💡 学んだ概念・パターン` などの TODO セクションを削除
   - `## 🔗 関連ノート` の空のセクションを削除
   - セッション ID、時刻などのメタ情報を削除

2. **内容の整理**:

   - 実際の知識や説明の部分を抽出
   - コード例や実践的な内容を残す
   - 構造化された見出しと内容を保持
   - メタデータのみのファイルでも、構造化して保存

3. **コードブロックの処理**:

   - コードブロック（\`\`\`言語名 で囲まれた部分）を検出
   - 言語名を識別（html, css, javascript, js, typescript, ts, python, etc.）
   - コードブロックの内容を整形（インデント整理、不要な空行削除）
   - 「## コードスニペット」セクションを作成して配置
   - 複数のコードブロックがある場合は、関連性を考慮して順序付け
   - コードの言語に応じたタグを追加（#html-snippet, #css-snippet, #javascript-snippet など）

4. **タイトルの生成**:

   - 内容から最も適切なタイトルを生成
   - 具体性を持たせる（元のファイル名の内容部分を活用）
   - メタデータのみの場合は、ファイル名や内容から推測
   - コードが主な内容の場合は、コードの種類をタイトルに含める
     - 例: 「レスポンシブヘッダー-HTML-CSS 実装」
     - 例: 「マウスストーカーボタン-JavaScript 実装」

5. **Inbox 形式への変換**:

   - 日付: 今日の日付（YYYYMMDD 形式）
   - ファイル名: `YYYYMMDD_タイトル.md`
   - 内容: 整理された構造化されたメモ
   - コードスニペットがある場合は「## コードスニペット」セクションを含める

6. **ファイルの作成**:
   - `01_Inbox/` フォルダに新規ファイルを作成
   - 内容を書き込む

### ステップ 4: アーカイブ移動

1. 全ての元ファイルを `99_Archive/` に移動
2. 同名ファイルが存在する場合は番号を付ける

### ステップ 5: 空フォルダの削除

1. `00_Memo/` 内の空のフォルダを検索
2. 空のフォルダを全て削除（README.md 等も含む）
3. 削除したフォルダ数を記録

### ステップ 6: 結果の報告

処理結果をまとめて報告：

- 変換したファイル数
- 削除した空フォルダ数
- エラー数と理由

## 重要：変換時の注意点

### 基本方針

**全てのファイルを必ず読み込んで整形する**

ファイル名だけで判断せず、必ずファイルの中身を全て読んでから整形すること。

### メタデータのみのファイルの処理

メタデータのみのファイルでも、以下のように整理して変換する：

```markdown
# [元のファイル名または内容から推測したタイトル]

## 概要

セッション記録やファイル操作の記録

## 内容

[メタデータから推測できる内容]

- セッション ID: xxx
- 日時: xxx
- 種別: xxx

## 次アクション

- [ ] 必要に応じて内容を確認

#inbox #session-record
```

### 実質的な内容があるファイルの処理

実質的な知識や学びが含まれているファイルは、それを中心に整形する：

```markdown
# [内容から生成したタイトル]

## 概要

[何についてのメモか、1-2 文で要約]

## 内容

[実質的な知識や学びを整理]

## コードスニペット

[コードが含まれている場合のみ追加]

\`\`\`[言語名]
[コード内容]
\`\`\`

## 次アクション

- [ ] 関連ノートにリンク
- [ ] 必要に応じて Memory Note に変換
- [ ] コードスニペットの場合は 04_Memory/Technical/Programming/への移動を検討

#inbox #tag1 #tag2 #[言語名]-snippet
```

**注意**: コードスニペットがない場合は「## コードスニペット」セクションは追加しない

## ヒント

- **自動実行**: 承認不要で即座に移動します
- 完全に自由な形式のメモを整理
- トピックが複数ある場合は分割を推奨
- ファイル名は必ず内容から生成
- 日付は今日の日付を使用
- 元のファイルは 99_Archive に移動（削除ではなく）
- トピックが不明確な場合は[[07_System/Documentation/system-overview.md]]を参照
- **コードスニペット対応**: HTML、CSS、JavaScript などのコードブロックを自動検出して整形
- コードが主な内容の場合は、言語名をファイル名に含める（例: `HTML-CSS実装.md`）
- 再利用可能なコードスニペットは、後で`04_Memory/Technical/Programming/`に移動することを推奨

関連プロンプト: [[08_prompts/01_整理系/20250113_Memo→Inbox変換.md]]

## 使用例

```
/memo-to-inbox                    # 00_Memo内の全ファイルをリスト表示
/memo-to-inbox 雑メモ.md         # 特定のファイルを変換
/memo-to-inbox 学んだこと.txt     # 拡張子が違ってもOK
```

## 処理例

### 例: 全てのファイルを変換

全てのファイルが必ず Inbox 形式に変換されます。メタデータのみのファイルでも、構造化して保存します。

ファイル: `2025-10-23-10-04-59_セッション終了_完了.md`

**読み込んだ内容**:

```markdown
---
type: cursor-session
event: stop
date: 2025-10-23
tags: [cursor, ai-conversation, session-end]
---

# ✅ セッション終了記録

## 📊 セッション概要

- ステータス: completed
```

**変換後**:

```markdown
# セッション終了記録

## 概要

セッション記録

## 内容

- 日時: 2025-10-23
- 種別: セッション終了
- ステータ ID: xxx

## 次アクション

- [ ] 必要に応じて内容を確認

#inbox #session-record
```

### 例: コードスニペットを含むメモの変換

ファイル: `ヘッダー実装メモ.md`

**読み込んだ内容**:

```markdown
レスポンシブヘッダー作った

HTML:

<div class="header">
  <nav>
    <ul>
      <li><a href="#">Home</a></li>
    </ul>
  </nav>
</div>

CSS:
.header {
display: flex;
padding: 20px;
}
```

**変換後**:

```markdown
# レスポンシブヘッダー-HTML-CSS 実装

## 概要

レスポンシブ対応のヘッダーナビゲーションの実装メモ

## 内容

レスポンシブヘッダーを作成した。フレックスボックスを使用してレイアウトを実装。

## コードスニペット

### HTML

\`\`\`html

<div class="header">
  <nav>
    <ul>
      <li><a href="#">Home</a></li>
    </ul>
  </nav>
</div>
\`\`\`

### CSS

\`\`\`css
.header {
display: flex;
padding: 20px;
}
\`\`\`

## 次アクション

- [ ] 関連ノートにリンク
- [ ] 必要に応じて Memory Note に変換（コードスニペットの場合）
- [ ] 04_Memory/Technical/Programming/HTML-CSS/ への移動を検討

#inbox #html-snippet #css-snippet #web-development
```
